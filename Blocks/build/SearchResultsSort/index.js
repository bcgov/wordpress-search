(()=>{"use strict";var e={n:s=>{var t=s&&s.__esModule?()=>s.default:()=>s;return e.d(t,{a:t}),t},d:(s,t)=>{for(var r in t)e.o(t,r)&&!e.o(s,r)&&Object.defineProperty(s,r,{enumerable:!0,get:t[r]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.blocks,t=window.wp.i18n,r=window.wp.components,l=window.wp.blockEditor,o=window.wp.apiFetch;var i=e.n(o);const a=window.wp.element,n=window.ReactJSXRuntime,c=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"wordpress-search/searchresultssort","version":"1.0.0","title":"Search Results Sort","category":"search","icon":"sort","description":"A sort control for search results that sorts by relevance_date custom field","attributes":{"selectedMetaField":{"type":"string","default":""},"sortOrder":{"type":"string","default":"asc"}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","viewStyle":"file://view.css","viewScript":"file://view.js","render":"file://render.php","style":"file://view.css","dependencies":["wp-api-fetch","wp-components","wp-element","wp-i18n"]}');(0,s.registerBlockType)(c.name,{...c,edit:function({attributes:e,setAttributes:s}){const{selectedMetaField:o,sortOrder:c}=e,[d,h]=(0,a.useState)([]),[p,u]=(0,a.useState)(!0),w=(0,a.useCallback)((e=>{let s=e.metaKey||e.value;if(s.includes(":")){const e=s.split(":");s=e[e.length-1]}const t=s.toLowerCase();return["file_name","file_size","file_type","file_url","file_versions","file_id","document_file_name","document_file_size","document_file_type","document_file_url","document_file_versions","document_file_id"].some((e=>t.includes(e.toLowerCase())))}),[]),_=(0,a.useCallback)((e=>{let s=e;if(e.includes(":")){const t=e.split(":");s=t[t.length-1]}let t=s.replace(/_/g," ");t=t.replace(/\b\w/g,(e=>e.toUpperCase()));const r={"Sort Relevance":"Sort Relevance","Document File Name":"File Name","Document File Url":"File URL","Document File Size":"File Size","Document File Type":"File Type","Post Date":"Publication Date","Page Order":"Page Order",This2:"This 2"};return r[t]?r[t]:t}),[]),f=(0,a.useCallback)((async()=>{u(!0);try{const e=await i()({path:"/wordpress-search/v1/meta-fields",method:"GET"});if(e&&e.length>0){const s=e.filter((e=>!w(e)));h(s)}else h([])}catch(e){h([])}finally{u(!1)}}),[w]);(0,a.useEffect)((()=>{f()}),[f]),(0,a.useEffect)((()=>{0===d.length&&f()}),[o,d.length,f]);const m=[{label:(0,t.__)("Ascending","wordpress-search"),value:"asc"},{label:(0,t.__)("Descending","wordpress-search"),value:"desc"}],x=d.map((e=>({label:_(e.value),value:e.value})));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.InspectorControls,{children:(0,n.jsxs)(r.PanelBody,{title:(0,t.__)("Sort Configuration","wordpress-search"),initialOpen:!0,children:[(0,n.jsx)("p",{className:"components-base-control__help",children:(0,t.__)("Configure the default sorting behavior for this block.","wordpress-search")}),!p&&0===d.length&&(0,n.jsx)("div",{style:{padding:"12px",background:"#f0f0f0",borderRadius:"4px",marginBottom:"8px",textAlign:"center"},children:(0,n.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#666"},children:(0,t.__)("No metadata fields found. Check that your posts have custom metadata.","wordpress-search")})}),p&&(0,n.jsx)("p",{children:(0,t.__)("Loading available fieldsâ€¦","wordpress-search")}),!p&&d.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.RadioControl,{label:(0,t.__)("Default Metadata Field for Sorting","wordpress-search"),help:(0,t.__)("Select which metadata field should be used as the default sort option. Leave empty to show only title sorting options.","wordpress-search"),selected:o,options:[{label:(0,t.__)("None (Title sorting only)","wordpress-search"),value:""},...x],onChange:e=>{s({selectedMetaField:e})}}),o&&(0,n.jsx)(r.SelectControl,{label:(0,t.__)("Default Sort Order for Metadata","wordpress-search"),help:(0,t.__)("Choose the default sort order when the metadata field is selected.","wordpress-search"),value:c,options:m,onChange:e=>{s({sortOrder:e})}})]})]})}),(0,n.jsx)("div",{...(0,l.useBlockProps)(),children:(0,n.jsx)("div",{className:"wp-block-wordpress-search-searchresultssort",children:(0,n.jsx)("div",{className:"search-results-sort",children:(0,n.jsx)("div",{className:"search-results-sort__controls",children:(0,n.jsxs)("div",{className:"search-results-sort__field-group",children:[(0,n.jsxs)("svg",{className:"search-results-sort__icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,n.jsx)("line",{x1:"6",y1:"4",x2:"6",y2:"20",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("polyline",{points:"3,17 6,20 9,17",fill:"none",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("line",{x1:"12",y1:"6",x2:"20",y2:"6",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("line",{x1:"12",y1:"10",x2:"18",y2:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("line",{x1:"12",y1:"14",x2:"16",y2:"14",stroke:"currentColor",strokeWidth:"2"})]}),(0,n.jsx)("label",{className:"search-results-sort__label",htmlFor:"preview-sort-select",children:(0,t.__)("Sort by:","wordpress-search")}),(0,n.jsxs)("select",{id:"preview-sort-select",className:"search-results-sort__sort-select",disabled:!0,style:{opacity:.7},children:[(0,n.jsx)("option",{children:(0,t.__)("Title (Alphabetical)","wordpress-search")}),(0,n.jsx)("option",{children:(0,t.__)("Title (Reverse Alphabetical)","wordpress-search")}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("option",{selected:"asc"===c,children:`${_(o)} (${(0,t.__)("Ascending","wordpress-search")})`}),(0,n.jsx)("option",{selected:"desc"===c,children:`${_(o)} (${(0,t.__)("Descending","wordpress-search")})`})]})]})]})})})})})]})}})})();